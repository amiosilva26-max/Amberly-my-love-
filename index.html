<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>For Amberly Valanka Fernandes</title>
    <style>
        :root { --pink: #ff4d6d; --dark: #590d22; --light: #fff0f3; --gold: #ffb703; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--light); color: var(--dark); overflow: hidden; touch-action: manipulation; }
        .screen { position: absolute; width: 100%; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; transition: 0.5s; background: var(--light); z-index: 10; }
        .hidden { display: none !important; }
        .card { background: white; padding: 25px; width: 85%; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 3px dashed var(--pink); box-sizing: border-box; }
        #display-img { max-width: 90%; max-height: 40vh; border: 5px solid white; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); margin-bottom: 15px; }
        .letter-content { width: 85%; max-height: 50vh; overflow-y: auto; background: white; padding: 20px; border-radius: 15px; border-left: 5px solid var(--pink); text-align: left; font-size: 0.95rem; line-height: 1.6; white-space: pre-line; box-sizing: border-box; }
        button { background: var(--pink); color: white; border: none; padding: 14px 28px; border-radius: 50px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin: 10px; box-shadow: 0 4px 10px rgba(255, 77, 109, 0.3); transition: 0.3s; z-index: 100; }
        #no-btn { background: #6c757d; position: relative; }
        .surprise-btn { background: #ff0054; font-size: 1.5rem; padding: 20px 40px; animation: pulse 1.5s infinite; border: 4px solid var(--gold); }
        #gameCanvas { background: linear-gradient(#87CEEB, #e0f2f1); width: 100vw; height: 50vh; display: block; border-top: 4px solid var(--pink); }
        #touch-zone { width: 100vw; height: 25vh; background: white; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--pink); font-size: 1.5rem; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes spin { from {transform: rotate(0deg);} to {transform: rotate(360deg);} }
    </style>
</head>
<body>

    <div id="screen-card" class="screen">
        <div class="card">
            <h1 style="color: var(--pink);">Hi Amberly! ‚ù§Ô∏è</h1>
            <p>I made something special for you.</p>
            <button onclick="showSection('screen-slideshow')">Click to Start üíå</button>
        </div>
    </div>

    <div id="screen-slideshow" class="screen hidden">
        <img id="display-img" src="Snapchat-1108914825.jpg">
        <p id="slide-text" style="font-weight: bold; color: var(--pink); min-height: 2em;"></p>
        <button onclick="nextSlide()">Next ‚ù§Ô∏è</button>
    </div>

    <div id="screen-letter" class="screen hidden">
        <div class="letter-content">
            <h2 style="text-align:center">To My Dearest Amberly,</h2>
            Every moment with you is like a perfectly cooked meal‚Äîfull of flavor and making me want more! You're my favorite foodie, my best friend, and my whole heart. 

            I love you more than all the pizzas in the world! 
        </div>
        <button onclick="showSection('screen-proposal')">Next...</button>
    </div>

    <div id="screen-proposal" class="screen hidden">
        <h1 id="prop-text">Will you be my Valentine?</h1>
        <div id="btn-container">
            <button onclick="respond('yes')">YES! ‚ù§Ô∏è</button>
            <button id="no-btn" onmouseover="moveNo()" onclick="moveNo()">NO üò≠</button>
        </div>
    </div>

    <div id="screen-warning" class="screen hidden">
        <div class="card">
            <h2 style="color: var(--pink);">WARNING: HARD MODE!</h2>
            <p>To see your surprise, reach 50 points!</p>
            <p style="color: red; font-weight: bold;">Watch out... some of them jump! üèÉ‚Äç‚ôÇÔ∏è</p>
            <h1 style="font-size: 3rem; color: #ff0054; margin: 10px 0;">50</h1>
            <button onclick="showSection('screen-game')">I'M READY! üèÉ‚Äç‚ôÄÔ∏è</button>
        </div>
    </div>

    <div id="screen-game" class="screen hidden">
        <div style="background: white; padding: 10px; font-weight: bold; width: 100%;">
            Score: <span id="score">0</span> / 50 üíÉ
        </div>
        <canvas id="gameCanvas"></canvas>
        <div id="touch-zone" onclick="handleJump()">TAP TO JUMP!</div>
    </div>

    <div id="screen-surprise-btn" class="screen hidden">
        <h1 style="color: var(--pink)">PRO GAMER STATUS! üéâ</h1>
        <p>You truly earned this, Amberly!</p>
        <button class="surprise-btn" onclick="playFinalSurprise()">OPEN YOUR GIFT üéÅ</button>
    </div>

    <div id="screen-video" class="screen hidden">
        <video id="finalVid" width="300" height="500" style="border-radius: 15px; background: #000;" controls playsinline>
            <source src="surprise.mp4" type="video/mp4">
        </video>
        <br>
        <button onclick="location.reload()">Back to Start ‚ù§Ô∏è</button>
    </div>

    <audio id="sfx-pop" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>
    <audio id="sfx-win" src="https://assets.mixkit.co/active_storage/sfx/1435/1435-preview.mp3"></audio>
    <audio id="sfx-fail" src="https://assets.mixkit.co/active_storage/sfx/253/253-preview.mp3"></audio>

    <script>
        const images = [
            { src: 'Snapchat-1108914825.jpg', msg: "Remember this? My heart melted." },
            { src: 'Snapchat-2038672580.jpg', msg: "My beautiful foodie girl! üçî" },
            { src: 'Snapchat-359429037.jpg', msg: "I love our goofy moments! ü§™" },
            { src: 'Snapchat-756657078.jpg', msg: "You're just perfect, Amberly." },
            { src: 'Snapchat-502016680.jpg', msg: "Ready for the challenge?" }
        ];

        let currentSlide = 0;
        let score = 0;
        let isGameOver = false;
        let noClicks = 0;
        let player, obstacles, canvas, ctx;

        function showSection(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            if(id === 'screen-game') initGame();
        }

        function nextSlide() {
            currentSlide++;
            if (currentSlide < images.length) {
                document.getElementById('display-img').src = images[currentSlide].src;
                document.getElementById('slide-text').innerText = images[currentSlide].msg;
                document.getElementById('sfx-pop').play();
            } else { showSection('screen-letter'); }
        }
        document.getElementById('slide-text').innerText = images[0].msg;

        function moveNo() {
            const noBtn = document.getElementById('no-btn');
            noClicks++;
            noBtn.style.position = 'absolute';
            noBtn.style.left = Math.random() * 70 + 'vw';
            noBtn.style.top = Math.random() * 70 + 'vh';
            if(noClicks > 9) {
                noBtn.innerText = "YES! ‚ù§Ô∏è";
                noBtn.style.background = "var(--pink)";
                noBtn.onclick = () => respond('yes');
            }
        }

        function respond(type) {
            if(type === 'yes') {
                document.getElementById('sfx-win').play();
                showSection('screen-warning');
            }
        }

        function playFinalSurprise() {
            showSection('screen-video');
            document.getElementById('finalVid').play();
        }

        function initGame() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight * 0.5;
            resetGame();
            updateLoop();
            spawnObstacle();
        }

        function resetGame() {
            score = 0;
            isGameOver = false;
            obstacles = [];
            document.getElementById('score').innerText = "0";
            player = { x: 50, y: canvas.height - 80, dy: 0, jumpForce: 15, gravity: 0.7, grounded: false };
        }

        function spawnObstacle() {
            if(!isGameOver && score < 50) {
                // Randomly decide if this boy is a jumper
                let isJumper = Math.random() > 0.6; 
                obstacles.push({ 
                    x: canvas.width + 50, 
                    y: canvas.height - 80, 
                    dy: 0, 
                    willJump: isJumper, 
                    hasJumped: false,
                    emoji: isJumper ? "üèÉ‚Äç‚ôÇÔ∏è" : "üßç‚Äç‚ôÇÔ∏è" 
                });
                setTimeout(spawnObstacle, 1200 + Math.random() * 600);
            }
        }

        function handleJump() {
            if(player.grounded) {
                player.dy = -player.jumpForce;
                player.grounded = false;
                document.getElementById('sfx-pop').currentTime = 0;
                document.getElementById('sfx-pop').play();
            }
        }

        function updateLoop() {
            if(isGameOver) return;
            ctx.clearRect(0,0, canvas.width, canvas.height);
            ctx.fillStyle = "#2ecc71";
            ctx.fillRect(0, canvas.height - 30, canvas.width, 30);
            
            player.dy += player.gravity;
            player.y += player.dy;
            if(player.y > canvas.height - 80) { player.y = canvas.height - 80; player.grounded = true; }
            ctx.font = "40px Arial";
            ctx.fillText("üíÉ", player.x, player.y + 40);

            obstacles.forEach((ob, i) => {
                ob.x -= (6 + (score / 15)); // Gradually speeds up

                // JUMPING LOGIC FOR OBSTACLES
                if(ob.willJump && !ob.hasJumped && ob.x < player.x + 200) {
                    ob.dy = -10; // The boy jumps!
                    ob.hasJumped = true;
                }
                
                if(ob.hasJumped) {
                    ob.dy += 0.5; // Gravity for the boy
                    ob.y += ob.dy;
                    if(ob.y > canvas.height - 80) ob.y = canvas.height - 80;
                }

                ctx.fillText(ob.emoji, ob.x, ob.y + 40);

                // COLLISION (More precise for jumping)
                let dx = player.x - ob.x;
                let dy = player.y - ob.y;
                let distance = Math.sqrt(dx*dx + dy*dy);
                if(distance < 35) {
                    document.getElementById('sfx-fail').play();
                    resetGame();
                }

                if(ob.x < -50) { 
                    obstacles.splice(i, 1); 
                    score++; 
                    document.getElementById('score').innerText = score;
                    if(score >= 50) {
                        isGameOver = true;
                        document.getElementById('sfx-win').play();
                        showSection('screen-surprise-btn');
                    }
                }
            });
            requestAnimationFrame(updateLoop);
        }
    </script>
</body>
</html>
